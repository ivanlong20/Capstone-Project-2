<%-include("header.ejs")%>

<div class="d-flex flex-column flex-wrap justify-content-start my-5 mb-3 me-5 gap-3 ">

  <div class="d-flex flex-wrap justify-content-end gap-3  mb-1 align-self-end">
    <a href="/post/edit-access/<%= post.id %>" class="btn btn-secondary ">Edit</a>
    <a href="/delete-post-access/<%=post.id %>" class="btn btn-danger d-flex justify-content-center align-items-center flex-wrap" style="text-align: center;">
      <div style="line-height: 0;" class="d-block m-0">
        <svg style="height: 1.3rem; fill:white;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
          <path d="m32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48v-336h-384zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1 -32 0zm320-176h-120l-9.4-18.7a24 24 0 0 0 -21.5-13.3h-114.3a23.72 23.72 0 0 0 -21.4 13.3l-9.4 18.7h-120a16 16 0 0 0 -16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0 -16-16z"/></svg>
      
      </div>
       
      </a>
  </div>

  <% var formatedDate = new Date(post.date).toLocaleString("en-HK",{year: "numeric", month:"long", day:"numeric", hour:"numeric", minute:"numeric"}); %>

  <% if(locals.post){ %>
    <div class="container text-light" style="width:60vw">
      <h1 class="fw-5"><%=post.title %></a></h1>
      <p style="font-weight: 200;"><%=formatedDate %></p>
      <p style="font-weight: 300;"><%=post.author %></p>
      <p style="width:50vw;line-height: 200%;font-weight: 500;"><%=post.content %></p>
    </div>

  <% } %>

  <div class="d-block container " style="width:60vw">
    <h2 class="text-white mt-5 mb-4 fw-3">Comments</h2>
    <% console.log(locals.post.comments) %>
    <% if(locals.post.comments.length > 0){ %>
      <% post.comments.forEach(function(comment){ %>
        <div class="d-flex flex-wrap justify-content-between align-items-center bg-dark rounded-3 p-3 mb-3">
          <p class="text-light fs-5"><%=comment.comment %></p>
          <div style="font-size:12px;font-weight:300;color:white" class="align-self-end"><%= new Date(comment.timestamp).toLocaleString("en-HK",{year: "numeric", month:"numeric", day:"numeric", hour:"numeric", minute:"numeric"}) %></div>
        </div>
        <% })} else{%>
          <p class="text-light fs-5 fw-2 mb-4">No comments yet</p>
          <% } %>
<% %>
    <form method="POST" action="/post/<%= post.id %>/comment" class="d-flex flex-column ">
      <textarea
      name="comment"
      placeholder="Leave your thoughts here !  🫵🏿"
      style=" height: 10em"
      class="bg-darker rounded-3 text-light p-3 "
      required
    >
</textarea ><br />
      <button type="submit" class="btn btn-light mb-5">Post</button>
    </form>
  </div>


</div>
   

 <%-include("footer.ejs")%>
